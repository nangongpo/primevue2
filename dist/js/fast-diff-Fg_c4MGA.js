var d=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function x(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var j=-1,E=1,D=0;function O(r,e,n,g,l){if(r===e)return r?[[D,r]]:[];if(n!=null){var a=f(r,e,n);if(a)return a}var h=U(r,e),v=r.substring(0,h);r=r.substring(h),e=e.substring(h),h=P(r,e);var i=r.substring(r.length-h);r=r.substring(0,r.length-h),e=e.substring(0,e.length-h);var c=W(r,e);return v&&c.unshift([D,v]),i&&c.push([D,i]),z(c,l),g&&B(c),c}function W(r,e){var n;if(!r)return[[E,e]];if(!e)return[[j,r]];var g=r.length>e.length?r:e,l=r.length>e.length?e:r,a=g.indexOf(l);if(a!==-1)return n=[[E,g.substring(0,a)],[D,l],[E,g.substring(a+l.length)]],r.length>e.length&&(n[0][0]=n[2][0]=j),n;if(l.length===1)return[[j,r],[E,e]];var h=Y(r,e);if(h){var v=h[0],i=h[1],c=h[2],t=h[3],u=h[4],_=O(v,c),b=O(i,t);return _.concat([[D,u]],b)}return X(r,e)}function X(r,e){for(var n=r.length,g=e.length,l=Math.ceil((n+g)/2),a=l,h=2*l,v=new Array(h),i=new Array(h),c=0;c<h;c++)v[c]=-1,i[c]=-1;v[a+1]=0,i[a+1]=0;for(var t=n-g,u=t%2!==0,_=0,b=0,A=0,S=0,F=0;F<l;F++){for(var s=-F+_;s<=F-b;s+=2){var p=a+s,m;s===-F||s!==F&&v[p-1]<v[p+1]?m=v[p+1]:m=v[p-1]+1;for(var M=m-s;m<n&&M<g&&r.charAt(m)===e.charAt(M);)m++,M++;if(v[p]=m,m>n)b+=2;else if(M>g)_+=2;else if(u){var w=a+t-s;if(w>=0&&w<h&&i[w]!==-1){var R=n-i[w];if(m>=R)return G(r,e,m,M)}}}for(var I=-F+A;I<=F-S;I+=2){var w=a+I,R;I===-F||I!==F&&i[w-1]<i[w+1]?R=i[w+1]:R=i[w-1]+1;for(var o=R-I;R<n&&o<g&&r.charAt(n-R-1)===e.charAt(g-o-1);)R++,o++;if(i[w]=R,R>n)S+=2;else if(o>g)A+=2;else if(!u){var p=a+t-I;if(p>=0&&p<h&&v[p]!==-1){var m=v[p],M=a+m-p;if(R=n-R,m>=R)return G(r,e,m,M)}}}}return[[j,r],[E,e]]}function G(r,e,n,g){var l=r.substring(0,n),a=e.substring(0,g),h=r.substring(n),v=e.substring(g),i=O(l,a),c=O(h,v);return i.concat(c)}function U(r,e){if(!r||!e||r.charAt(0)!==e.charAt(0))return 0;for(var n=0,g=Math.min(r.length,e.length),l=g,a=0;n<l;)r.substring(a,l)==e.substring(a,l)?(n=l,a=n):g=l,l=Math.floor((g-n)/2+n);return J(r.charCodeAt(l-1))&&l--,l}function Z(r,e){var n=r.length,g=e.length;if(n==0||g==0)return 0;n>g?r=r.substring(n-g):n<g&&(e=e.substring(0,n));var l=Math.min(n,g);if(r==e)return l;for(var a=0,h=1;;){var v=r.substring(l-h),i=e.indexOf(v);if(i==-1)return a;h+=i,(i==0||r.substring(l-h)==e.substring(0,h))&&(a=h,h++)}}function P(r,e){if(!r||!e||r.slice(-1)!==e.slice(-1))return 0;for(var n=0,g=Math.min(r.length,e.length),l=g,a=0;n<l;)r.substring(r.length-l,r.length-a)==e.substring(e.length-l,e.length-a)?(n=l,a=n):g=l,l=Math.floor((g-n)/2+n);return K(r.charCodeAt(r.length-l))&&l--,l}function Y(r,e){var n=r.length>e.length?r:e,g=r.length>e.length?e:r;if(n.length<4||g.length*2<n.length)return null;function l(b,A,S){for(var F=b.substring(S,S+Math.floor(b.length/4)),s=-1,p="",m,M,w,R;(s=A.indexOf(F,s+1))!==-1;){var I=U(b.substring(S),A.substring(s)),o=P(b.substring(0,S),A.substring(0,s));p.length<o+I&&(p=A.substring(s-o,s)+A.substring(s,s+I),m=b.substring(0,S-o),M=b.substring(S+I),w=A.substring(0,s-o),R=A.substring(s+I))}return p.length*2>=b.length?[m,M,w,R,p]:null}var a=l(n,g,Math.ceil(n.length/4)),h=l(n,g,Math.ceil(n.length/2)),v;if(!a&&!h)return null;h?a?v=a[4].length>h[4].length?a:h:v=h:v=a;var i,c,t,u;r.length>e.length?(i=v[0],c=v[1],t=v[2],u=v[3]):(t=v[0],u=v[1],i=v[2],c=v[3]);var _=v[4];return[i,c,t,u,_]}function B(r){for(var e=!1,n=[],g=0,l=null,a=0,h=0,v=0,i=0,c=0;a<r.length;)r[a][0]==D?(n[g++]=a,h=i,v=c,i=0,c=0,l=r[a][1]):(r[a][0]==E?i+=r[a][1].length:c+=r[a][1].length,l&&l.length<=Math.max(h,v)&&l.length<=Math.max(i,c)&&(r.splice(n[g-1],0,[j,l]),r[n[g-1]+1][0]=E,g--,g--,a=g>0?n[g-1]:-1,h=0,v=0,i=0,c=0,l=null,e=!0)),a++;for(e&&z(r),q(r),a=1;a<r.length;){if(r[a-1][0]==j&&r[a][0]==E){var t=r[a-1][1],u=r[a][1],_=Z(t,u),b=Z(u,t);_>=b?(_>=t.length/2||_>=u.length/2)&&(r.splice(a,0,[D,u.substring(0,_)]),r[a-1][1]=t.substring(0,t.length-_),r[a+1][1]=u.substring(_),a++):(b>=t.length/2||b>=u.length/2)&&(r.splice(a,0,[D,t.substring(0,b)]),r[a-1][0]=E,r[a-1][1]=u.substring(0,u.length-b),r[a+1][0]=j,r[a+1][1]=t.substring(b),a++),a++}a++}}var $=/[^a-zA-Z0-9]/,k=/\s/,H=/[\r\n]/,T=/\n\r?\n$/,C=/^\r?\n\r?\n/;function q(r){function e(b,A){if(!b||!A)return 6;var S=b.charAt(b.length-1),F=A.charAt(0),s=S.match($),p=F.match($),m=s&&S.match(k),M=p&&F.match(k),w=m&&S.match(H),R=M&&F.match(H),I=w&&b.match(T),o=R&&A.match(C);return I||o?5:w||R?4:s&&!m&&M?3:m||M?2:s||p?1:0}for(var n=1;n<r.length-1;){if(r[n-1][0]==D&&r[n+1][0]==D){var g=r[n-1][1],l=r[n][1],a=r[n+1][1],h=P(g,l);if(h){var v=l.substring(l.length-h);g=g.substring(0,g.length-h),l=v+l.substring(0,l.length-h),a=v+a}for(var i=g,c=l,t=a,u=e(g,l)+e(l,a);l.charAt(0)===a.charAt(0);){g+=l.charAt(0),l=l.substring(1)+a.charAt(0),a=a.substring(1);var _=e(g,l)+e(l,a);_>=u&&(u=_,i=g,c=l,t=a)}r[n-1][1]!=i&&(i?r[n-1][1]=i:(r.splice(n-1,1),n--),r[n][1]=c,t?r[n+1][1]=t:(r.splice(n+1,1),n--))}n++}}function z(r,e){r.push([D,""]);for(var n=0,g=0,l=0,a="",h="",v;n<r.length;){if(n<r.length-1&&!r[n][1]){r.splice(n,1);continue}switch(r[n][0]){case E:l++,h+=r[n][1],n++;break;case j:g++,a+=r[n][1],n++;break;case D:var i=n-l-g-1;if(e){if(i>=0&&V(r[i][1])){var c=r[i][1].slice(-1);if(r[i][1]=r[i][1].slice(0,-1),a=c+a,h=c+h,!r[i][1]){r.splice(i,1),n--;var t=i-1;r[t]&&r[t][0]===E&&(l++,h=r[t][1]+h,t--),r[t]&&r[t][0]===j&&(g++,a=r[t][1]+a,t--),i=t}}if(L(r[n][1])){var c=r[n][1].charAt(0);r[n][1]=r[n][1].slice(1),a+=c,h+=c}}if(n<r.length-1&&!r[n][1]){r.splice(n,1);break}if(a.length>0||h.length>0){a.length>0&&h.length>0&&(v=U(h,a),v!==0&&(i>=0?r[i][1]+=h.substring(0,v):(r.splice(0,0,[D,h.substring(0,v)]),n++),h=h.substring(v),a=a.substring(v)),v=P(h,a),v!==0&&(r[n][1]=h.substring(h.length-v)+r[n][1],h=h.substring(0,h.length-v),a=a.substring(0,a.length-v)));var u=l+g;a.length===0&&h.length===0?(r.splice(n-u,u),n=n-u):a.length===0?(r.splice(n-u,u,[E,h]),n=n-u+1):h.length===0?(r.splice(n-u,u,[j,a]),n=n-u+1):(r.splice(n-u,u,[j,a],[E,h]),n=n-u+2)}n!==0&&r[n-1][0]===D?(r[n-1][1]+=r[n][1],r.splice(n,1)):n++,l=0,g=0,a="",h="";break}}r[r.length-1][1]===""&&r.pop();var _=!1;for(n=1;n<r.length-1;)r[n-1][0]===D&&r[n+1][0]===D&&(r[n][1].substring(r[n][1].length-r[n-1][1].length)===r[n-1][1]?(r[n][1]=r[n-1][1]+r[n][1].substring(0,r[n][1].length-r[n-1][1].length),r[n+1][1]=r[n-1][1]+r[n+1][1],r.splice(n-1,1),_=!0):r[n][1].substring(0,r[n+1][1].length)==r[n+1][1]&&(r[n-1][1]+=r[n+1][1],r[n][1]=r[n][1].substring(r[n+1][1].length)+r[n+1][1],r.splice(n+1,1),_=!0)),n++;_&&z(r,e)}function J(r){return r>=55296&&r<=56319}function K(r){return r>=56320&&r<=57343}function L(r){return K(r.charCodeAt(0))}function V(r){return J(r.charCodeAt(r.length-1))}function y(r){for(var e=[],n=0;n<r.length;n++)r[n][1].length>0&&e.push(r[n]);return e}function Q(r,e,n,g){return V(r)||L(g)?null:y([[D,r],[j,e],[E,n],[D,g]])}function f(r,e,n){var g=typeof n=="number"?{index:n,length:0}:n.oldRange,l=typeof n=="number"?null:n.newRange,a=r.length,h=e.length;if(g.length===0&&(l===null||l.length===0)){var v=g.index,i=r.slice(0,v),c=r.slice(v),t=l?l.index:null;r:{var u=v+h-a;if(t!==null&&t!==u||u<0||u>h)break r;var _=e.slice(0,u),b=e.slice(u);if(b!==c)break r;var A=Math.min(v,u),S=i.slice(0,A),F=_.slice(0,A);if(S!==F)break r;var s=i.slice(A),p=_.slice(A);return Q(S,s,p,c)}r:{if(t!==null&&t!==v)break r;var m=v,_=e.slice(0,m),b=e.slice(m);if(_!==i)break r;var M=Math.min(a-m,h-m),w=c.slice(c.length-M),R=b.slice(b.length-M);if(w!==R)break r;var s=c.slice(0,c.length-M),p=b.slice(0,b.length-M);return Q(i,s,p,w)}}if(g.length>0&&l&&l.length===0)r:{var S=r.slice(0,g.index),w=r.slice(g.index+g.length),A=S.length,M=w.length;if(h<A+M)break r;var F=e.slice(0,A),R=e.slice(h-M);if(S!==F||w!==R)break r;var s=r.slice(A,a-M),p=e.slice(A,h-M);return Q(S,s,p,w)}return null}function N(r,e,n,g){return O(r,e,n,g,!0)}N.INSERT=E;N.DELETE=j;N.EQUAL=D;var rr=N;export{d as c,rr as d,x as g};
//# sourceMappingURL=fast-diff-Fg_c4MGA.js.map
