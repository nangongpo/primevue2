import{ObjectUtils as e,DomHandler as t}from"primevue2/utils";import n from"primevue2/ripple";function i(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=s(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,o=function(){};return{s:o,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var l,a=!0,r=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){r=!0,l=e},f:function(){try{a||null==n.return||n.return()}finally{if(r)throw l}}}}function o(e){return r(e)||a(e)||s(e)||l()}function l(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function s(e,t){if(e){if("string"==typeof e)return p(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?p(e,t):void 0}}function a(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function r(e){if(Array.isArray(e))return p(e)}function p(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var u={name:"Listbox",props:{value:null,options:Array,optionLabel:null,optionValue:null,optionDisabled:null,listStyle:null,disabled:Boolean,dataKey:null,multiple:Boolean,metaKeySelection:Boolean,filter:Boolean,filterPlaceholder:String,filterLocale:String,emptyFilterMessage:{type:String,default:"No results found"}},optionTouched:!1,data:function(){return{filterValue:null}},methods:{getOptionLabel:function(t){return this.optionLabel?e.resolveFieldData(t,this.optionLabel):t},getOptionValue:function(t){return this.optionValue?e.resolveFieldData(t,this.optionValue):t},getOptionRenderKey:function(t){return this.dataKey?e.resolveFieldData(t,this.dataKey):this.getOptionLabel(t)},isOptionDisabled:function(t){return!!this.optionDisabled&&e.resolveFieldData(t,this.optionDisabled)},onOptionSelect:function(e,t){this.disabled||this.isOptionDisabled(t)||(this.multiple?this.onOptionSelectMultiple(e,t):this.onOptionSelectSingle(e,t),this.optionTouched=!1)},onOptionTouchEnd:function(){this.disabled||(this.optionTouched=!0)},onOptionSelectSingle:function(e,t){var n=this.isSelected(t),i=!1,o=null;!this.optionTouched&&this.metaKeySelection?n?(e.metaKey||e.ctrlKey)&&(o=null,i=!0):(o=this.getOptionValue(t),i=!0):(o=n?null:this.getOptionValue(t),i=!0);i&&this.updateModel(e,o)},onOptionSelectMultiple:function(e,t){var n=this.isSelected(t),i=!1,l=null;if(!this.optionTouched&&this.metaKeySelection){var s=e.metaKey||e.ctrlKey;n?(l=s?this.removeOption(t):[this.getOptionValue(t)],i=!0):(l=[].concat(o(l=s&&this.value||[]),[this.getOptionValue(t)]),i=!0)}else l=n?this.removeOption(t):[].concat(o(this.value||[]),[this.getOptionValue(t)]),i=!0;i&&this.updateModel(e,l)},isSelected:function(t){var n=!1,o=this.getOptionValue(t);if(this.multiple){if(this.value){var l,s=i(this.value);try{for(s.s();!(l=s.n()).done;){if(e.equals(l.value,o,this.equalityKey)){n=!0;break}}}catch(e){s.e(e)}finally{s.f()}}}else n=e.equals(this.value,o,this.equalityKey);return n},removeOption:function(t){var n=this;return this.value.filter((function(i){return!e.equals(i,n.getOptionValue(t),n.equalityKey)}))},updateModel:function(e,t){this.$emit("input",t),this.$emit("change",{originalEvent:e,value:t})},onOptionKeyDown:function(e,t){var n=e.currentTarget;switch(e.which){case 40:var i=this.findNextItem(n);i&&i.focus(),e.preventDefault();break;case 38:var o=this.findPrevItem(n);o&&o.focus(),e.preventDefault();break;case 13:this.onOptionSelect(e,t),e.preventDefault()}},findNextItem:function(e){var n=e.nextElementSibling;return n?t.hasClass(n,"p-disabled")?this.findNextOption(n):n:null},findPrevItem:function(e){var n=e.previousElementSibling;return n?t.hasClass(n,"p-disabled")?this.findPrevItem(n):n:null},onFilterChange:function(e){this.$emit("filter",{originalEvent:e,value:e.target.value})}},computed:{visibleOptions:function(){var e=this;return this.filterValue?this.options.filter((function(t){return e.getOptionLabel(t).toLocaleLowerCase(e.filterLocale).indexOf(e.filterValue.toLocaleLowerCase(e.filterLocale))>-1})):this.options},equalityKey:function(){return this.optionValue?null:this.dataKey}},directives:{ripple:n}};function c(e,t,n,i,o,l,s,a,r,p){"boolean"!=typeof s&&(r=a,a=s,s=!1);const u="function"==typeof n?n.options:n;let c;if(e&&e.render&&(u.render=e.render,u.staticRenderFns=e.staticRenderFns,u._compiled=!0,o&&(u.functional=!0)),i&&(u._scopeId=i),l?(c=function(e){(e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),t&&t.call(this,r(e)),e&&e._registeredComponents&&e._registeredComponents.add(l)},u._ssrRegister=c):t&&(c=s?function(e){t.call(this,p(e,this.$root.$options.shadowRoot))}:function(e){t.call(this,a(e))}),c)if(u.functional){const e=u.render;u.render=function(t,n){return c.call(n),e(t,n)}}else{const e=u.beforeCreate;u.beforeCreate=e?[].concat(e,c):[c]}return n}const d="undefined"!=typeof navigator&&/msie [6-9]\\b/.test(navigator.userAgent.toLowerCase());function h(e){return(e,t)=>m(e,t)}let f;const v={};function m(e,t){const n=d?t.media||"default":e,i=v[n]||(v[n]={ids:new Set,styles:[]});if(!i.ids.has(e)){i.ids.add(e);let n=t.source;if(t.map&&(n+="\n/*# sourceURL="+t.map.sources[0]+" */",n+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(t.map))))+" */"),i.element||(i.element=document.createElement("style"),i.element.type="text/css",t.media&&i.element.setAttribute("media",t.media),void 0===f&&(f=document.head||document.getElementsByTagName("head")[0]),f.appendChild(i.element)),"styleSheet"in i.element)i.styles.push(n),i.element.styleSheet.cssText=i.styles.filter(Boolean).join("\n");else{const e=i.ids.size-1,t=document.createTextNode(n),o=i.element.childNodes;o[e]&&i.element.removeChild(o[e]),o.length?i.element.insertBefore(t,o[e]):i.element.appendChild(t)}}}var b=u,y=function(){var e=this,t=e._self._c||e.$createElement;return t("div",{staticClass:"p-listbox p-component"},[e.filter?t("div",{staticClass:"p-listbox-header"},[t("div",{staticClass:"p-listbox-filter-container"},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.filterValue,expression:"filterValue"}],staticClass:"p-listbox-filter p-inputtext p-component",attrs:{type:"text",placeholder:e.filterPlaceholder},domProps:{value:e.filterValue},on:{input:[function(t){t.target.composing||(e.filterValue=t.target.value)},e.onFilterChange]}}),e._v(" "),t("span",{staticClass:"p-listbox-filter-icon pi pi-search"})])]):e._e(),e._v(" "),t("div",{staticClass:"p-listbox-list-wrapper",style:e.listStyle},[t("ul",{staticClass:"p-listbox-list",attrs:{role:"listbox","aria-multiselectable":"multiple"}},[e._l(e.visibleOptions,(function(n,i){return t("li",{directives:[{name:"ripple",rawName:"v-ripple"}],key:e.getOptionRenderKey(n),class:["p-listbox-item",{"p-highlight":e.isSelected(n),"p-disabled":e.isOptionDisabled(n)}],attrs:{tabindex:e.isOptionDisabled(n)?null:"0","aria-label":e.getOptionLabel(n),role:"option","aria-selected":e.isSelected(n)},on:{click:function(t){return e.onOptionSelect(t,n)},touchend:function(t){return e.onOptionTouchEnd()},keydown:function(t){return e.onOptionKeyDown(t,n)}}},[e._t("option",(function(){return[e._v("\n          "+e._s(e.getOptionLabel(n))+"\n        ")]}),{option:n,index:i})],2)})),e._v(" "),e.filterValue&&(!e.visibleOptions||e.visibleOptions&&0===e.visibleOptions.length)?t("li",{staticClass:"p-listbox-empty-message"},[e._v("\n        "+e._s(e.emptyFilterMessage)+"\n      ")]):e._e()],2)])])};y._withStripped=!0;var g=c({render:y,staticRenderFns:[]},(function(e){e&&e("data-v-8668915c_0",{source:"\n.p-listbox-list-wrapper {\n  overflow: auto;\n}\n.p-listbox-list {\n  list-style-type: none;\n  margin: 0;\n  padding: 0;\n}\n.p-listbox-item {\n  cursor: pointer;\n  position: relative;\n  overflow: hidden;\n}\n.p-listbox-filter-container {\n  position: relative;\n}\n.p-listbox-filter-icon {\n  position: absolute;\n  top: 50%;\n  margin-top: -.5rem;\n}\n.p-listbox-filter {\n  width: 100%;\n}\n",map:{version:3,sources:["/Users/nangongpo/Desktop/开源学习/primevue2/src/components/listbox/Listbox.vue"],names:[],mappings:";AAyQA;EACA,cAAA;AACA;AAEA;EACA,qBAAA;EACA,SAAA;EACA,UAAA;AACA;AAEA;EACA,eAAA;EACA,kBAAA;EACA,gBAAA;AACA;AAEA;EACA,kBAAA;AACA;AAEA;EACA,kBAAA;EACA,QAAA;EACA,kBAAA;AACA;AAEA;EACA,WAAA;AACA",file:"Listbox.vue",sourcesContent:['<template>\n  <div class="p-listbox p-component">\n    <div class="p-listbox-header" v-if="filter">\n      <div class="p-listbox-filter-container">\n        <input\n          type="text"\n          class="p-listbox-filter p-inputtext p-component"\n          v-model="filterValue"\n          :placeholder="filterPlaceholder"\n          @input="onFilterChange" />\n        <span class="p-listbox-filter-icon pi pi-search"></span>\n      </div>\n    </div>\n    <div class="p-listbox-list-wrapper" :style="listStyle">\n      <ul class="p-listbox-list" role="listbox" aria-multiselectable="multiple">\n        <li\n          v-for="(option, i) of visibleOptions"\n          :tabindex="isOptionDisabled(option) ? null : \'0\'"\n          :class="[\'p-listbox-item\', { \'p-highlight\': isSelected(option), \'p-disabled\': isOptionDisabled(option) }]"\n          v-ripple\n          :aria-label="getOptionLabel(option)"\n          :key="getOptionRenderKey(option)"\n          @click="onOptionSelect($event, option)"\n          @touchend="onOptionTouchEnd()"\n          @keydown="onOptionKeyDown($event, option)"\n          role="option"\n          :aria-selected="isSelected(option)">\n          <slot name="option" :option="option" :index="i">\n            {{ getOptionLabel(option) }}\n          </slot>\n        </li>\n        <li\n          v-if="filterValue && (!visibleOptions || (visibleOptions && visibleOptions.length === 0))"\n          class="p-listbox-empty-message">\n          {{ emptyFilterMessage }}\n        </li>\n      </ul>\n    </div>\n  </div>\n</template>\n\n<script>\nimport { ObjectUtils, DomHandler } from \'primevue2/utils\'\nimport Ripple from \'primevue2/ripple\'\n\nexport default {\n  name: \'Listbox\',\n  props: {\n    value: null,\n    options: Array,\n    optionLabel: null,\n    optionValue: null,\n    optionDisabled: null,\n    listStyle: null,\n    disabled: Boolean,\n    dataKey: null,\n    multiple: Boolean,\n    metaKeySelection: Boolean,\n    filter: Boolean,\n    filterPlaceholder: String,\n    filterLocale: String,\n    emptyFilterMessage: {\n      type: String,\n      default: \'No results found\'\n    }\n  },\n  optionTouched: false,\n  data() {\n    return {\n      filterValue: null\n    }\n  },\n  methods: {\n    getOptionLabel(option) {\n      return this.optionLabel ? ObjectUtils.resolveFieldData(option, this.optionLabel) : option\n    },\n    getOptionValue(option) {\n      return this.optionValue ? ObjectUtils.resolveFieldData(option, this.optionValue) : option\n    },\n    getOptionRenderKey(option) {\n      return this.dataKey ? ObjectUtils.resolveFieldData(option, this.dataKey) : this.getOptionLabel(option)\n    },\n    isOptionDisabled(option) {\n      return this.optionDisabled ? ObjectUtils.resolveFieldData(option, this.optionDisabled) : false\n    },\n    onOptionSelect(event, option) {\n      if (this.disabled || this.isOptionDisabled(option)) {\n        return\n      }\n\n      if (this.multiple)\n        this.onOptionSelectMultiple(event, option)\n      else\n        this.onOptionSelectSingle(event, option)\n\n      this.optionTouched = false\n    },\n    onOptionTouchEnd() {\n      if (this.disabled) {\n        return\n      }\n\n      this.optionTouched = true\n    },\n    onOptionSelectSingle(event, option) {\n      let selected = this.isSelected(option)\n      let valueChanged = false\n      let value = null\n      let metaSelection = this.optionTouched ? false : this.metaKeySelection\n\n      if (metaSelection) {\n        let metaKey = (event.metaKey || event.ctrlKey)\n\n        if (selected) {\n          if (metaKey) {\n            value = null\n            valueChanged = true\n          }\n        }\n        else {\n          value = this.getOptionValue(option)\n          valueChanged = true\n        }\n      }\n      else {\n        value = selected ? null : this.getOptionValue(option)\n        valueChanged = true\n      }\n\n      if (valueChanged) {\n        this.updateModel(event, value)\n      }\n    },\n    onOptionSelectMultiple(event, option) {\n      let selected = this.isSelected(option)\n      let valueChanged = false\n      let value = null\n      let metaSelection = this.optionTouched ? false : this.metaKeySelection\n\n      if (metaSelection) {\n        let metaKey = (event.metaKey || event.ctrlKey)\n\n        if (selected) {\n          if (metaKey)\n            value = this.removeOption(option)\n          else\n            value = [this.getOptionValue(option)]\n\n          valueChanged = true\n        }\n        else {\n          value = (metaKey) ? this.value || [] : []\n          value = [...value, this.getOptionValue(option)]\n          valueChanged = true\n        }\n      }\n      else {\n        if (selected)\n          value = this.removeOption(option)\n        else\n          value = [...this.value || [], this.getOptionValue(option)]\n\n        valueChanged = true\n      }\n\n      if (valueChanged) {\n        this.updateModel(event, value)\n      }\n    },\n    isSelected(option) {\n      let selected = false\n      let optionValue = this.getOptionValue(option)\n\n      if (this.multiple) {\n        if (this.value) {\n          for (let val of this.value) {\n            if (ObjectUtils.equals(val, optionValue, this.equalityKey)) {\n              selected = true\n              break\n            }\n          }\n        }\n      }\n      else {\n        selected = ObjectUtils.equals(this.value, optionValue, this.equalityKey)\n      }\n\n      return selected\n    },\n    removeOption(option) {\n      return this.value.filter(val => !ObjectUtils.equals(val, this.getOptionValue(option), this.equalityKey))\n    },\n    updateModel(event, value) {\n      this.$emit(\'input\', value)\n      this.$emit(\'change\', { originalEvent: event, value: value })\n    },\n    onOptionKeyDown(event, option) {\n      let item = event.currentTarget\n\n      switch (event.which) {\n      //down\n      case 40:\n        var nextItem = this.findNextItem(item)\n        if (nextItem) {\n          nextItem.focus()\n        }\n\n        event.preventDefault()\n        break\n\n        //up\n      case 38:\n        var prevItem = this.findPrevItem(item)\n        if (prevItem) {\n          prevItem.focus()\n        }\n\n        event.preventDefault()\n        break\n\n        //enter\n      case 13:\n        this.onOptionSelect(event, option)\n        event.preventDefault()\n        break\n      }\n    },\n    findNextItem(item) {\n      let nextItem = item.nextElementSibling\n\n      if (nextItem)\n        return DomHandler.hasClass(nextItem, \'p-disabled\') ? this.findNextOption(nextItem) : nextItem\n      else\n        return null\n    },\n    findPrevItem(item) {\n      let prevItem = item.previousElementSibling\n\n      if (prevItem)\n        return DomHandler.hasClass(prevItem, \'p-disabled\') ? this.findPrevItem(prevItem) : prevItem\n      else\n        return null\n    },\n    onFilterChange(event) {\n      this.$emit(\'filter\', { originalEvent: event, value: event.target.value })\n    }\n  },\n  computed: {\n    visibleOptions() {\n      if (this.filterValue)\n        return this.options.filter(option => this.getOptionLabel(option).toLocaleLowerCase(this.filterLocale).indexOf(this.filterValue.toLocaleLowerCase(this.filterLocale)) > -1)\n      else\n        return this.options\n    },\n    equalityKey() {\n      return this.optionValue ? null : this.dataKey\n    }\n  },\n  directives: {\n    \'ripple\': Ripple\n  }\n}\n<\/script>\n\n<style>\n.p-listbox-list-wrapper {\n  overflow: auto;\n}\n\n.p-listbox-list {\n  list-style-type: none;\n  margin: 0;\n  padding: 0;\n}\n\n.p-listbox-item {\n  cursor: pointer;\n  position: relative;\n  overflow: hidden;\n}\n\n.p-listbox-filter-container {\n  position: relative;\n}\n\n.p-listbox-filter-icon {\n  position: absolute;\n  top: 50%;\n  margin-top: -.5rem;\n}\n\n.p-listbox-filter {\n  width: 100%;\n}\n</style>\n']},media:void 0})}),b,undefined,false,undefined,!1,h,void 0,void 0);export{g as default};
